<!--
  -  Junos switch and firewall decoders
  -  Created by Wazuh, Inc. <support@wazuh.com>.
  -  This program is a free software; you can redistribute it and/or modify it under the terms of GPLv2.
-->

<!-- firewall_log -->
<decoder name="cisco-asa">
    <program_name>cisco-asa</program_name>
</decoder>

<!--Nov  8 16:11:18 X.X.X.X cisco-asa: RT_FLOW: RT_FLOW_SESSION_CLOSE: session closed idle Timeout: X.X.X.X/55141->X.X.X.X/389 0x0 None X.X.X.X/55141->X.X.X.X/389 0x0 N/A N/A N/A N/A 17 In_to_Server2 inside Server_Farm_interface 124774 1(242) 1(222) 60 UNKNOWN UNKNOWN N/A(N/A) reth1.0 UNKNOWN

Nov  8 16:11:13 X.X.X.X cisco-asa: RT_FLOW: RT_FLOW_SESSION_CREATE: session created X.X.X.X/60406->X.X.X.X/53 0x0 junos-dns-udp X.X.X.X/60406->X.X.X.X/53 0x0 N/A N/A N/A N/A 17 In_to_Server2 inside Server_Farm_interface 122284 N/A(N/A) reth1.0 UNKNOWN UNKNOWN UNKNOWN 
-->


<decoder name="Junos-session">
    <parent>cisco-asa</parent>
    <prematch>RT_FLOW: \.+: </prematch>
    <regex offset="after_prematch">(\.+) (\S+)/(\S+)->(\S+)/(\S+) \d+\w+\d (\S+) \S+/\S+ </regex>
    <order>action, src_ip, src_port, dst_ip, dst_port,service.Name</order>
</decoder>



<!-- acces switcch -->
<decoder name="cisco-ios">
        <program_name>cisco-ios</program_name>
</decoder>

<!-- 
 Nov  8 16:15:13 X.X.X.X cisco-ios: alarmd: Alarm cleared: PS SFXPC color=YELLOW, class=CHASSIS, reason=FPC 2 PEM 1 is not powered
Nov  8 16:15:17 X.X.X.X cisco-ios: alarmd: Alarm set: PS SFXPC color=YELLOW, class=CHASSIS, reason=FPC 2 PEM 1 is not powered

-->

<decoder name="Junos-alarm">
        <parent>cisco-ios</parent>
        <use_own_name>false</use_own_name>
        <prematch>alarmd: </prematch>
        <regex offset="after_prematch">(\S+): (\.+)color=(\S+), class=(\S+), reason=(\.+)</regex>
        <order>alarm.action, alarm.name, alarm.color, alarm.class, alarm.reason</order>
</decoder>



<!-- 
NOV  8 16:15:13 X.X.X.X CISCO-IOS: CRAFTD: MINOR ALARM CLEARED, FPC 2 PEM 1 IS NOT POWERED
NOV  8 16:15:12 X.X.X.X CISCO-IOS: CRAFTD:  MINOR ALARM SET, FPC 2 PEM 1 IS NOT POWERED
Nov  8 16:15:17 X.X.X.X cisco-ios: craftd: Receive FX craftd set alarm message: color: 2 class: 100 object: 75 slot: 5 silent: 0 short_reason=FPC 2 PEM 1 No Powe long_reason=FPC 2 PEM 1 is not powered id=167773515 reason=167772160
Nov  8 16:15:13 X.X.X.X cisco-ios: craftd: Receive FX craftd clear alarm message: color: Minor class: 100 slot: 5 
Nov  8 16:15:17 X.X.X.X cisco-ios: craftd: Receive FX craftd set alarm message: color: 2 class: 100 
-->

<decoder name="Junos-craft-ac1">
        <parent>cisco-ios</parent>
        <use_own_name>false</use_own_name>
        <prematch>craftd:\s+\.+\s+color:\s+\.+\s+class:\s+\.+\s</prematch>
        <regex>craftd:\s+(\.+)\s+color:\s+(\.+)\s+class:\s+(\.+)\s</regex>
        <order>craft.action, craft.color, craft.class</order>
</decoder>

<decoder name="Junos-craft-ac1">
        <parent>cisco-ios</parent>
        <regex offset="after_regex">object: (\.+) </regex>
        <order>craft.object</order>
</decoder>

<decoder name="Junos-craft-ac1">
        <parent>cisco-ios</parent>
        <regex offset="after_regex">slot: (\d+) </regex>
        <order>craft.slot</order>
</decoder>


<decoder name="Junos-craft-ac1">
        <parent>cisco-ios</parent>
        <regex offset="after_regex">silent: (\.) short_reason=(\.+) long_reason=(\.+) id=(\d+) </regex>
        <order>craft.slient, craft.short_reason, craft.long_reason, craft.id</order>
</decoder>



<decoder name="Junos-craft-default">
        <parent>cisco-ios</parent>
        <use_own_name>false</use_own_name>
        <prematch>craftd: </prematch>
        <regex offset="after_prematch">(\.+), (\.+)</regex>
        <order>craft.message, craft.reason</order>
</decoder>



<!-- 
Oct 25 22:20:55 X.X.X.X cisco-ios: xntpd: receive: Unexpected origin timestamp from 172.19.52.1
Oct 25 22:20:55 X.X.X.X cisco-ios: xntpd: NTP Server Unreachable
-->


<decoder name="Junos-NTP-ac1">
        <parent>cisco-ios</parent>
        <prematch>xntpd:\s*\S+:</prematch>
        <regex>xntpd:\s*(\S+): </regex>
        <order>ntp.action</order>
</decoder>

<decoder name="Junos-NTP-ac1">
        <parent>cisco-ios</parent>
        <regex offset="after_regex">(\.+) from (\S+)</regex>
        <order>ntp.message, ntp.ip</order>
</decoder>

<decoder name="Junos-NTP-default">
        <parent>cisco-ios</parent>
        <prematch>xntpd: </prematch>
        <regex offset="after_prematch">(\.+)</regex>
        <order>ntp.info</order>
</decoder>



<!-- 
Oct 25 22:21:09 X.X.X.X cisco-ios: last: message repeated 7 times
Oct 25 22:21:11 X.X.X.X cisco-ios: last: message repeated 8 times
-->
<decoder name="Junos-Info-1">
        <parent>cisco-ios</parent>
        <prematch>last: </prematch>
        <regex offset="after_prematch">(\.+) (\d+) </regex>
        <order>last.message, last.count</order>
</decoder>


<!-- 
Oct 25 22:15:00 X.X.X.X cisco-ios: cron: (root) CMD ( /usr/libexec/atrun)
Oct 25 22:15:00 X.X.X.X cisco-ios: cron: (root) CMD (newsyslog)

-->
<decoder name="Junos-Info-2">
        <parent>cisco-ios</parent>
        <prematch>cron: </prematch>
        <regex offset="after_prematch">\((\.+)\) CMD \((\.+)\)</regex>
        <order>cron.user, cron.action</order>
</decoder>


<!--
Nov 20 06:32:35 PUNGDC-FDCS-DIST_SF last: message repeated 24 times
Nov 20 06:35:00 PUNGDC-FDCS-DIST_SF : (root) CMD (   /usr/libexec/atrun)
Nov 20 06:41:23 PUNGDC-FDCS-DIST_SF fpc0: vlan-id(32768) to bd-id mapping doesn't exist in itable
Nov 20 06:40:00 PUNGDC-FDCS-DIST_SF chassisd: pem_mojito_offline slot 3 offlined
Nov 20 07:08:50 PUNGDC-FDCS-DIST_SF chassisd: CHASSISD_SNMP_TRAP6: SNMP trap generated: Power Supply failed (jnxContentsContainerIndex 2, jnxContentsL1Index 1, jnxContentsL2Index 2, jnxContentsL3Index 0, jnxContentsDescr Power Supply: Power Supply 1 @ 0/1/*, jnxOperatingState/Temp 6)

-->



<decoder name="Junos-switch-Info">
        <program_name>last|chassisd</program_name>
</decoder>


<decoder name="Junos-switch-info">
        <parent>Junos-switch-Info</parent>
        <prematch>message repeated</prematch>
        <regex offset="after_prematch"> (\d+) </regex>
        <order>last.Repeatedcount</order>
</decoder>

<decoder name="Junos-switch-TrapInfo">
        <parent>Junos-switch-Info</parent>
        <prematch>\S+: \S+ trap generated: \.+</prematch>
        <regex>(\S+): (\S+) trap generated: (\.+)</regex>
        <order>Trap.source, Trap.protocol, Trap.details</order>
</decoder>

<decoder name="Junos-switch-SlotsInfo">
        <parent>Junos-switch-Info</parent>
        <regex offset="after_parent">(\.+) slot (\d+) offlined</regex>
        <order>device, offlined.slots</order>
</decoder>


<decoder name="Junos-switch-FPC-Info">
        <program_name>fpc0</program_name>
</decoder>


<decoder name="Junos-dist-Info-fpc">
        <parent>Junos-switch-FPC-Info</parent>
        <regex offset="after_parent">(\S+) to (\S+) (\.+)</regex>
        <order>from, to, message</order>
</decoder>



<decoder name="Junos-switch-Cron-Info">
  <program_name></program_name>
</decoder>
<decoder name="Junos-dist-info3">
   <parent>Junos-switch-Cron-Info</parent>
   <regex>(\(\S+\)) \S+ (\(\s+\S+\))</regex>
   <order>cron.user, cron.action</order>
</decoder>
