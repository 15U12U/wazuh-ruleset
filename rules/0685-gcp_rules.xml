<!--
  -  Google Cloud Pub/Sub rules
  -  Created by Wazuh, Inc.
  -  Copyright (C) 2015-2019, Wazuh Inc.
  -  This program is a free software; you can redistribute it and/or modify it under the terms of GPLv2.
-->

<!--
ID: 65000 - 65499
-->
<group name="gcp,">
    <!-- GCP wodle -->
    <rule id="65000" level="0">
        <decoded_as>json</decoded_as>
        <field name="resource.labels.project_id">\.+</field>
        <description>Google Cloud Pub/Sub alert</description>
        <options>no_full_log</options>
    </rule>

    <rule id="65001" level="10">
        <if_sid>65000</if_sid>
        <field name="jsonPayload.responseCode">^ERROR$</field>
        <description>GCP error</description>
        <options>no_full_log</options>
    </rule>

    <rule id="65002" level="5">
        <if_sid>65000</if_sid>
        <field name="severity">^NOTICE$</field>
        <description>GCP notice event</description>
        <options>no_full_log</options>
    </rule>

    <rule id="65003" level="3">
        <if_sid>65000</if_sid>
        <field name="resource.labels.source_type">^gcp-vm$</field>
        <description>GCP virtual machine event</description>
        <options>no_full_log</options>
    </rule>

    <rule id="65004" level="3">
        <if_sid>65003</if_sid>
        <field name="jsonPayload.vmInstanceId">\.+</field>
        <field name="jsonPayload.vmInstanceName">\.+</field>
        <description>GCP virtual machine instance $(jsonPayload.vmInstanceName) with ID $(jsonPayload.vmInstanceId)</description>
        <options>no_full_log</options>
    </rule>

    <rule id="65005" level="3">
        <if_sid>65000</if_sid>
        <field name="resource.labels.source_type">^internet$</field>
        <description>GCP internet event</description>
        <options>no_full_log</options>
    </rule>
</group>
