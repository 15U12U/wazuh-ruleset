# Security Configuration Assessment
# Level 2 CIS Checks for Debian Linux 10
# Copyright (C) 2015-2020, Wazuh Inc.
#
# This program is free software; you can redistribute it
# and/or modify it under the terms of the GNU General Public
# License (version 2) as published by the FSF - Free Software
# Foundation
#
# Based on:
# Center for Internet Security Debian Linux 10 Benchmark v1.0.0 - 02-13-2020

policy:
  id: "cis_debian10_L2"
  file: "cis_debian10_L2.yml"
  name: "CIS benchmark for Debian/Linux 10 L2"
  description: "This document provides prescriptive guidance for establishing a secure configuration posture for Debian Linux 10."
  references:
    - https://www.cisecurity.org/cis-benchmarks/

requirements:
  title: "Check Debian version"
  description: "Requirements for running the SCA scan against Debian/Ubuntu."
  condition: all
  rules:
    - 'f:/etc/debian_version'
    - 'f:/proc/sys/kernel/ostype -> Linux'

checks:


############################################################
# 1 Initial Setup
############################################################



############################################################
# 2 Services
############################################################



############################################################
# 3 Network Configuration
############################################################
############################################################
# 3.1 Disable unused network protocols and devices
############################################################
# 3.1.1 Disable IPv6 (Not Scored)
  - id: 3800
    title: "Disable IPv6"
    description: "Although IPv6 has many advantages over IPv4, not all organizations have IPv6 or dual stack configurations implemented."
    rationale: "If IPv6 or dual stack is not to be used, it is recommended that IPv6 be disabled to reduce the attack surface of the system."
    remediation: "Edit /etc/default/grub and add ipv6.disable=1 to the GRUB_CMDLINE_LINUX parameters: GRUB_CMDLINE_LINUX=\"ipv6.disable=1\" Run the following command to update the grub2 configuration: # update-grub"
    compliance:
      - cis: ["3.1.1"]
      - cis_csc: ["9.4"]
      - pci_dss: ["2.2.3"]
      - nist_800_53: ["CM.1"]
      - gpg_13: ["4.3"]
      - gdpr_IV: ["35.7.d"]
      - hipaa: ["164.312.b"]
      - tsc: ["CC6.6","CC5.2"]
    condition: all
    rules:
      - 'f:/boot/grub/grub.cfg -> r:^\s*linux\.+ipv6.disable=1'

# 3.1.2 Ensure wireless interfaces are disabled (Scored)  
  - id: 3801 
    title: "Ensure wireless interfaces are disabled"
    description: "Wireless networking is used when wired networks are unavailable. Red Hat Enterprise Linux contains a wireless tool kit to allow system administrators to configure and use wireless networks."
    rationale: "If wireless is not to be used, wireless devices can be disabled to reduce the potential attack surface."
    remediation: "Run the following command to disable any wireless interfaces: # nmcli radio all off"
    compliance:
      - cis: ["3.1.2"]
      - cis_csc: ["15.4", "15.5"]
      - pci_dss: ["1.2.3"]
      - tsc: ["CC6.6"]
    references:
      - nmcli(1) - Linux man page
    condition: all
    rules:
      - 'c:nmcli radio wifi -> r:^disabled'
      - 'c:nmcli radio wwan -> r:^disabled'  


############################################################
# 4 Logging and Auditing
############################################################



############################################################
# 5 Access, Authentication and Authorization
############################################################
# 5.2.6 Ensure SSH X11 forwarding is disabled (Scored)
  - id: 3528
    title: "Ensure SSH X11 forwarding is disabled"
    description: "The X11Forwarding parameter provides the ability to tunnel X11 traffic through the connection to enable remote graphic connections."
    rationale: "Disable X11 forwarding unless there is an operational requirement to use X11 applications directly. There is a small risk that the remote X11 servers of users who are logged in via SSH with X11 forwarding could be compromised by other users on the X11 server. Note that even if X11 forwarding is disabled, users can always install their own forwarders."
    remediation: "Edit the /etc/ssh/sshd_configfile to set the parameter as follows: X11Forwarding no"
    compliance:
      - cis: ["5.2.6"]
      - cis_csc: ["9.2"]
      - pci_dss: ["2.2.3"]
      - nist_800_53: ["CM.1"]
      - tsc: ["CC5.2"]
      - gpg_13: ["4.3"]
      - gdpr_IV: ["35.7.d"]
      - hipaa: ["164.312.b"]
    condition: all
    rules:
      - 'f:/etc/ssh/sshd_config -> !r:^# && r:X11Forwarding\s+no'



############################################################
# 6 System Maintenance
############################################################