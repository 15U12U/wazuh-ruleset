[Sysmon EventID#1 - Suspicious svchost process]
log 1 pass = 2014 Dec 20 09:29:47 WinEvtLog: Microsoft-Windows-Sysmon/Operational: INFORMATION(1): Microsoft-Windows-Sysmon: SYSTEM: NT AUTHORITY: WIN-U93G48C7BOP: Process Create:  UtcTime: 12/20/2014 2:29 PM  ProcessGuid: {00000000-87DB-5495-0000-001045F25A00}  ProcessId: 3048  Image: C:\Windows\system32\svchost.exe  CommandLine: "C:\Windows\system32\NOTEPAD.EXE" C:\Users\Administrator\Desktop\ossec.log  User: WIN-U93G48C7BOP\Administrator  LogonGuid: {00000000-84B8-5494-0000-0020CB330200}  LogonId: 0x233CB  TerminalSessionId: 1  IntegrityLevel: High  HashType: SHA1  Hash: 9FEF303BEDF8430403915951564E0D9888F6F365  ParentProcessGuid: {00000000-84B9-5494-0000-0010BE4A0200}  ParentProcessId: 848  ParentImage: C:\Windows\Explorer.EXE  ParentCommandLine: C:\Windows\Explorer.EXE
rule = 184666
alert = 12
decoder = windows

[Sysmon EventID#1 - non-Suspicious svchost process]
log 1 pass = 2014 Dec 20 09:29:47 WinEvtLog: Microsoft-Windows-Sysmon/Operational: INFORMATION(1): Microsoft-Windows-Sysmon: SYSTEM: NT AUTHORITY: WIN-U93G48C7BOP: Process Create:  UtcTime: 12/20/2014 12:15 PM  ProcessGuid: {00000000-87DB-5495-0000-001045F25A00}  ProcessId: 3048  Image: C:\Windows\system32\svchost.exe  CommandLine: "C:\windows\system32\svchost.exe -k defragsvc"  User: NT AUTHORITY\SYSTEM  LogonGuid: {00000000-84B8-5494-0000-0020CB330200}  LogonId: 0x233CB  TerminalSessionId: 1  IntegrityLevel: High  HashType: SHA1  Hash: 9FEF303BEDF8430403915951564E0D9888F6F365  ParentProcessGuid: {00000000-84B9-5494-0000-0010BE4A0200}  ParentProcessId: 848  ParentImage: C:\Windows\System32\services.exe  ParentCommandLine: C:\Windows\System32\services.exe
rule = 184667
alert = 0
decoder = windows

[Windows Event]
log 1 pass = 2013 Oct 09 17:09:04 WinEvtLog: Application: INFORMATION(1): My Script: (no user): no domain: demo1.foo.example.com: test
rule = 18101
alert = 0
decoder = windows


[Sysmon - Event 1]
log 1 pass = 
rule = 184665
alert = 0
decoder = 

[Sysmon - Event 2]
log 1 pass = 
rule = 185000
alert = 0
decoder = 

[Sysmon - Event 3]
log 1 pass = 
rule = 185001
alert = 0
decoder = 

[Sysmon - Event 4]
log 1 pass = 
rule = 185002
alert = 0
decoder = 

[Sysmon - Event 5]
log 1 pass = 
rule = 185003
alert = 0
decoder = 

[Sysmon - Event 6]
log 1 pass = 
rule = 185004
alert = 0
decoder = 

[Sysmon - Event 7]
log 1 pass = 
rule = 185005
alert = 0
decoder = 

[Sysmon - Event 8]
log 1 pass = 
rule = 185006
alert = 0
decoder = 

[Sysmon - Event 9]
log 1 pass = 
rule = 185007
alert = 0
decoder = 

[Sysmon - Event 10]
log 1 pass = 
rule = 185008
alert = 0
decoder = 

[Sysmon - Event 11]
log 1 pass = 
rule = 185009
alert = 0
decoder = 

[Sysmon - Event 12]
log 1 pass = 
rule = 185010
alert = 0
decoder = 

[Sysmon - Event 13]
log 1 pass = 
rule = 185011
alert = 0
decoder = 

[Sysmon - Event 14]
log 1 pass = 
rule = 185012
alert = 0
decoder = 

[Sysmon - Event 15]
log 1 pass = 
rule = 185013
alert = 0
decoder = 

[Sysmon - Group of events]
log 1 pass = 
rule = 20485
alert = 0
decoder = 

[Sysmon - Event 1: Process creation $(win.eventdata.description)]
log 1 pass = 
rule = 20486
alert = 0
decoder = 

[Sysmon - Event 2: A process changed a file creation time by $(win.eventdata.sourceImage)]
log 1 pass = 
rule = 20487
alert = 0
decoder = 

[Sysmon - Event 3: Network connection by $(win.eventdata.sourceImage)]
log 1 pass = 
rule = 20488
alert = 0
decoder = 

[Sysmon - Event 4: Sysmon service state changed by $(win.eventdata.sourceImage)]
log 1 pass = 
rule = 20489
alert = 0
decoder = 

[Sysmon - Event 5: Process terminated by $(win.eventdata.sourceImage)]
log 1 pass = 
rule = 20490
alert = 0
decoder = 

[Sysmon - Event 6: Driver loaded by $(win.eventdata.sourceImage)]
log 1 pass = 
rule = 20491
alert = 0
decoder = 

[Sysmon - Event 7: Image loaded by $(win.eventdata.sourceImage)]
log 1 pass = 
rule = 20492
alert = 0
decoder = 

[Sysmon - Event 8: CreateRemoteThread by $(win.eventdata.sourceImage)]
log 1 pass = 
rule = 20493
alert = 0
decoder = 

[Sysmon - Event 9: RawAccessRead by $(win.eventdata.sourceImage)]
log 1 pass = 
rule = 20494
alert = 0
decoder = 

[Sysmon - Event 10: ProcessAccess by $(win.eventdata.sourceImage)]
log 1 pass = 
rule = 20495
alert = 0
decoder = 

[Sysmon - Event 11: FileCreate by $(win.eventdata.sourceImage)]
log 1 pass = 
rule = 20496
alert = 0
decoder = 

[Sysmon - Event 12: RegistryEvent (Object create and delete) by $(win.eventdata.sourceImage)]
log 1 pass = 
rule = 20497
alert = 0
decoder = 

[Sysmon - Event 13: RegistryEvent (Value Set) by $(win.eventdata.sourceImage)]
log 1 pass = 
rule = 20498
alert = 0
decoder = 

[Sysmon - Event 14: RegistryEvent (Key and Value Rename) by $(win.eventdata.sourceImage)]
log 1 pass = 
rule = 20499
alert = 0
decoder = 

[Sysmon - Event 15: FileCreateStreamHash by $(win.eventdata.sourceImage)]
log 1 pass = 
rule = 20500
alert = 0
decoder = 


[Sysmon - Suspicious Process - lsm.exe]
log 1 pass = 
rule = 184676
alert = 12
decoder = 

[Sysmon - Legitimate Parent Image - lsm.exe]
log 1 pass = 
rule = 184677
alert = 0
decoder = 

[Sysmon - Suspicious Process - lsm.exe is a Parent Image]
log 1 pass = 
rule = 184678
alert = 12
decoder = 

[Sysmon - Suspicious Process - csrss.exe]
log 1 pass = 
rule = 184686
alert = 12
decoder = 

[Sysmon - Legitimate Parent Image - csrss.exe]
log 1 pass = 
rule = 184687
alert = 0
decoder = 

[Sysmon - Suspicious Process - lsass]
log 1 pass = 
rule = 184696
alert = 12
decoder = 

[Sysmon - Legitimate Parent Image - lsass.exe]
log 1 pass = 
rule = 184697
alert = 0
decoder = 

[Sysmon - Suspicious Process - lsass.exe is a Parent Image]
log 1 pass = 
rule = 184698
alert = 12
decoder = 

[Sysmon - Suspicious Process - winlogon.exe]
log 1 pass = 
rule = 184706
alert = 12
decoder = 

[Sysmon - Legitimate Parent Image - winlogon.exe]
log 1 pass = 
rule = 184707
alert = 0
decoder = 

[Sysmon - Suspicious Process - wininit]
log 1 pass = 
rule = 184716
alert = 12
decoder = 

[Sysmon - Legitimate Parent Image - wininit.exe]
log 1 pass = 
rule = 184717
alert = 0
decoder = 

[Sysmon - Suspicious Process - smss.exe]
log 1 pass = 
rule = 184726
alert = 12
decoder = 

[Sysmon - Legitimate Parent Image - smss.exe]
log 1 pass = 
rule = 184727
alert = 0
decoder = 

[Sysmon - Suspicious Process - taskhost.exe]
log 1 pass = 
rule = 184736
alert = 12
decoder = 

[Sysmon - Legitimate Parent Image - taskhost.exe]
log 1 pass = 
rule = 184737
alert = 0
decoder = 

[Sysmon - Suspicious Process - services.exe]
log 1 pass = 
rule = 184746
alert = 12
decoder = 

[Sysmon - Legitimate Parent Image - services.exe]
log 1 pass = 
rule = 184747
alert = 0
decoder = 

[Sysmon - Suspicious Process - dllhost.exe]
log 1 pass = 
rule = 184766
alert = 12
decoder = 

[Sysmon - Legitimate Parent Image - dllhost.exe]
log 1 pass = 
rule = 184767
alert = 0
decoder = 

[Sysmon - Suspicious Process - explorer.exe]
log 1 pass = 
rule = 184776
alert = 12
decoder = 

[Sysmon - Legitimate Parent Image - explorer.exe]
log 1 pass = 
rule = 184777
alert = 0
decoder = 

[Sysmon - Suspicious Process - svchost.exe]
log 1 pass = 
rule = 20350
alert = 12
decoder = 

[Sysmon - Legitimate Parent Image - svchost.exe]
log 1 pass = 
rule = 20351
alert = 0
decoder = 

[Sysmon - Suspicious Process - lsm.exe]
log 1 pass = 
rule = 20352
alert = 12
decoder = 

[Sysmon - Legitimate Parent Image - lsm.exe]
log 1 pass = 
rule = 20353
alert = 0
decoder = 

[Sysmon - Suspicious Process - lsm.exe is a Parent Image]
log 1 pass = 
rule = 20354
alert = 12
decoder = 

[Sysmon - Suspicious Process - csrss.exe]
log 1 pass = 
rule = 20355
alert = 12
decoder = 

[Sysmon - Legitimate Parent Image - csrss.exe]
log 1 pass = 
rule = 20356
alert = 0
decoder = 

[Sysmon - Suspicious Process - lsass]
log 1 pass = 
rule = 20357
alert = 12
decoder = 

[Sysmon - Legitimate Parent Image - lsass.exe]
log 1 pass = 
rule = 20358
alert = 0
decoder = 

[Sysmon - Suspicious Process - lsass.exe is a Parent Image]
log 1 pass = 
rule = 20359
alert = 12
decoder = 

[Sysmon - Suspicious Process - winlogon.exe]
log 1 pass = 
rule = 20360
alert = 12
decoder = 

[Sysmon - Legitimate Parent Image - winlogon.exe]
log 1 pass = 
rule = 20361
alert = 0
decoder = 

[Sysmon - Suspicious Process - wininit]
log 1 pass = 
rule = 20362
alert = 12
decoder = 

[Sysmon - Legitimate Parent Image - wininit.exe]
log 1 pass = 
rule = 20363
alert = 0
decoder = 

[Sysmon - Suspicious Process - smss.exe]
log 1 pass = 
rule = 20364
alert = 12
decoder = 

[Sysmon - Legitimate Parent Image - smss.exe]
log 1 pass = 
rule = 20365
alert = 0
decoder = 

[Sysmon - Suspicious Process - taskhost.exe]
log 1 pass = 
rule = 20366
alert = 12
decoder = 

[Sysmon - Legitimate Parent Image - taskhost.exe]
log 1 pass = 
rule = 20367
alert = 0
decoder = 

[Sysmon - Suspicious Process - services.exe]
log 1 pass = 
rule = 20368
alert = 12
decoder = 

[Sysmon - Legitimate Parent Image - services.exe]
log 1 pass = 
rule = 20369
alert = 0
decoder = 

[Sysmon - Suspicious Process - dllhost.exe]
log 1 pass = 
rule = 20370
alert = 12
decoder = 

[Sysmon - Legitimate Parent Image - dllhost.exe]
log 1 pass = 
rule = 20371
alert = 0
decoder = 

[Sysmon - Suspicious Process - explorer.exe]
log 1 pass = 
rule = 20372
alert = 12
decoder = 

[Sysmon - Legitimate Parent Image - explorer.exe]
log 1 pass = 
rule = 20373
alert = 0
decoder = 

